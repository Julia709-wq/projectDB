# Проект 3. Поиск вакансий с подключением к БД

***Проект представляет собой программу, в ходе работы которой
происходит получение данные о компаниях и вакансиях с сайта hh.ru, проектирование
таблиц в БД PostgreSQL и загрузка полученные данные в созданные таблицы.***

---

## Интеграция с API

В проекте используется API https://dev.hh.ru/ для получения списка вакансий.
Вся работа с API реализована в модулях api_base и hh. 

В модуле api_base находится абстрактный класс 
**BaseAPI**, который определяет метод подключения к API и метод получения данных по поисковому запросу 
пользователя - одному слову. 

В модуле hh находится класс **HeadHunterAPI** для работы с конкретным API - платформой hh.ru.
Класс наследуется от абстрактного BaseAPI и имеет приватные атрибуты ___url_ и ___headers_.
Реализованы методы: 
* __connect_ - приватный метод подключения к API
* _get_data_ - метод получения данных по ключевому слову

Используемые библиотеки:
* abc - для создания абстрактного класса и его методов
* requests - для отправки запросов к API

---


## Подключение к БД

Подключение к базе данных происходит при инициализации объекта DBManager - класса для создания запросов к уже заполненным таблицам.
У пользователя запрашивается имя БД, в которой он хочет работать. В классе DBManager происходит инициализация подключения при
помощи приватного метода __connect_to_db_. Сначала происходит подключение к системной базе postgres, и только из нее происходит
подключение к БД, имя которой передано пользователем. При этом, если пользователь передает название уже существующей БД, программа подключается к ней,
В противном случае, создается БД с таким именем. Метод возвращает подключение к переданной БД. 

---

## Проектирование и заполнение таблиц

Проектирование таблиц реализовано в функции main, т.е., таблицы создаются при запуске программы. 
Создаются переменные типа str, в которые помещаются два запроса: на создание таблицы employers и таблицы vacancies.

После создания таблиц в функции main вызываются функции для заполнения таблиц: _fill_employers_tables()_ и _fill_vacancies_table()_.
Функции расположены в модуле db_utils. Внутри этих функций задан список "топовых" работодателей. Внутри функций происходит фильтрация вакансий,
затем создаются запросы на заполнение таблиц. 

---

## Запросы к таблицам

Уже упоминавшийся ранее класс DBManager содержит методы, реализующие запросы к таблицам:
 * _get_companies_and_vacancies_count()_ - метод для подсчета вакансий каждой компании. Реализован при помощи GROUP BY.
 * _get_all_vacancies()_ - метод получения списка всех вакансий вида: название компании, название вакансии, зарплата, ссылка. Реализован посредством объединения таблиц.
 * _get_avg_salary()_ - метод получения средней зарплаты по вакансиям. Реализован при помощи агрегирующей функции AVG.
 * _get_vacancies_with_higher_salary()_ - метод получения списка вакансий из всей таблицы, зарплата которых выше средней. Реализуется посредством применения WHERE.
 * _get_vacancies_with_keyword()_ - метод получения вакансий, в названии которых встречается ключевое слово, переданное пользователем. Используется оператор LIKE.
 * _delete_data()_ - метод создан для удобства проверки.